<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stokvel Pro - Premium Community Savings Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1a472a;
            --primary-light: #2d5a3d;
            --accent: #d4af37;
            --accent-light: #e8c96a;
            --neutral: #f8f9fa;
            --text-dark: #1a1a1a;
            --text-light: #6c757d;
            --shadow: 0 8px 30px rgba(0,0,0,0.12);
            --shadow-lg: 0 15px 40px rgba(0,0,0,0.15);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: 
                url('images/african-women-7559504_1280.jpg') center/cover fixed;
            color: var(--text-dark);
            min-height: 100vh;
            line-height: 1.6;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(8px);
            z-index: -1;
        }

        /* Main content wrapper to push footer down */
        .main-content {
            flex: 1 0 auto;
            width: 100%;
        }

        /* Premium Navbar */
        .navbar {
            background: rgba(0, 0, 0, 0.95) !important;
            backdrop-filter: blur(20px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            padding: 1rem 0;
            border-bottom: 3px solid var(--accent);
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.4rem;
            box-shadow: var(--shadow);
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Premium Cards */
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: none;
            border-radius: 16px;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            overflow: hidden;
            margin-bottom: 1.5rem;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .card-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            border-bottom: none;
            padding: 1.25rem 1.5rem;
            font-weight: 600;
            position: relative;
        }

        .card-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent), var(--accent-light));
        }

        /* Premium Stats Cards */
        .stats-card {
            text-align: center;
            padding: 2rem 1rem;
            position: relative;
            overflow: hidden;
            border-radius: 16px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .stats-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
        }

        .stats-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .stats-card .icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 2rem;
            color: white;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            box-shadow: var(--shadow);
        }

        .stats-card.accent .icon {
            background: linear-gradient(135deg, var(--accent), var(--accent-light));
        }

        .stats-card h3 {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stats-card p {
            color: var(--text-light);
            font-weight: 500;
            margin: 0;
        }

        /* Premium Tabs */
        .nav-tabs {
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 12px 12px 0 0;
            padding: 0.75rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .navbar .nav-link {
            color: rgba(255, 255, 255, 0.9) !important;
        }

        .navbar .nav-link:hover {
            color: var(--accent) !important;
        }

        .navbar .logo-text {
            background: linear-gradient(135deg, white, var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-tabs .nav-link.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            box-shadow: var(--shadow);
        }

        /* Premium Activity Items */
        .activity-item {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            border-radius: 12px;
            margin-bottom: 0.75rem;
            background: rgba(255, 255, 255, 0.8);
        }

        .activity-item:hover {
            background: white;
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        /* Premium Action Buttons */
        .action-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 20px;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            color: var(--text-light);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }

        .action-btn:hover {
            background: white;
            color: var(--primary);
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .action-btn.liked {
            background: rgba(212, 175, 55, 0.1);
            color: var(--accent);
            border-color: var(--accent);
        }

        /* Premium Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            display: flex;
            justify-content: space-around;
            padding: 0.75rem 0;
            box-shadow: 0 -2px 20px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            border-top: 3px solid var(--accent);
        }

        .bottom-nav .nav-item {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0.5rem;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .bottom-nav .nav-item.active {
            color: var(--accent);
            background: rgba(255, 255, 255, 0.1);
        }

        .bottom-nav .nav-item:hover {
            color: white;
        }

        .nav-icon {
            font-size: 1.25rem;
            margin-bottom: 4px;
        }

        .bottom-nav .nav-item span {
            font-size: 0.75rem;
            font-weight: 500;
        }

        /* Premium Buttons */
        .btn {
            border-radius: 10px;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .btn:active {
            transform: translateY(1px);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            box-shadow: 0 4px 15px rgba(26, 71, 42, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(26, 71, 42, 0.4);
        }

        .btn-accent {
            background: linear-gradient(135deg, var(--accent), var(--accent-light));
            color: white;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
        }

        .btn-accent:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.4);
            color: white;
        }

        .btn-outline-primary {
            border: 2px solid var(--primary);
            color: var(--primary);
            background: transparent;
        }

        .btn-outline-primary:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        /* Premium Badges */
        .badge {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.75rem;
        }

        .bg-primary { background: linear-gradient(135deg, var(--primary), var(--primary-light)) !important; }
        .bg-accent { background: linear-gradient(135deg, var(--accent), var(--accent-light)) !important; }

        /* Premium Progress Bars */
        .usage-bar {
            height: 8px;
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.1);
            overflow: hidden;
            margin: 1rem 0;
        }

        .usage-fill {
            height: 100%;
            border-radius: 10px;
            transition: all 0.5s ease;
            background: linear-gradient(135deg, var(--primary), var(--accent));
        }

        /* Premium Alert */
        .alert {
            border-radius: 12px;
            border: none;
            padding: 1.25rem;
            margin-bottom: 1.5rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .alert-warning {
            background: rgba(212, 175, 55, 0.1);
            color: var(--accent);
            border-left: 4px solid var(--accent);
        }

        .alert.alert-dismissible {
            padding-right: 3rem;
        }

        .alert .btn-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            padding: 0.75rem;
        }

        /* Premium Table */
        .table {
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .table th {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            border: none;
            padding: 1rem;
            font-weight: 600;
        }

        .table td {
            padding: 1rem;
            border-color: rgba(0, 0, 0, 0.05);
            vertical-align: middle;
        }

        .table tbody tr:hover {
            background: rgba(26, 71, 42, 0.05);
        }

        /* Premium Footer - FIXED */
        .legal-footer {
            background: rgba(0, 0, 0, 0.95);
            color: white;
            padding: 2rem 0;
            margin-top: auto;
            border-top: 3px solid var(--accent);
            flex-shrink: 0;
            width: 100%;
        }
        
        .legal-footer .text-muted {
            color: rgba(255, 255, 255, 0.7) !important;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(20px); }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        .fade-out {
            animation: fadeOut 0.3s ease forwards;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        .slide-in {
            animation: slideIn 0.5s ease;
        }

        /* Notification Badge */
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: linear-gradient(135deg, var(--accent), #e74c3c);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        /* Avatar */
        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary);
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
        }

        /* Quick Actions Enhancement */
        .quick-action-btn {
            transition: all 0.3s ease;
            border: 2px solid transparent;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .quick-action-btn:hover {
            transform: translateY(-3px);
            border-color: var(--accent);
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.3);
        }

        .quick-action-btn:active {
            transform: translateY(-1px);
            transition: transform 0.1s ease;
        }

        /* Consistent Popup/Modal Styling */
        .modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: none;
            border-radius: 16px;
            box-shadow: var(--shadow-lg);
            border-top: 4px solid var(--accent);
            animation: fadeIn 0.3s ease;
        }

        .modal-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            border-bottom: none;
            padding: 1.25rem 1.5rem;
            border-radius: 16px 16px 0 0;
        }

        .modal-header .btn-close {
            filter: invert(1);
            opacity: 0.8;
        }

        .modal-header .btn-close:hover {
            opacity: 1;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            padding: 1rem 1.5rem;
            background: rgba(248, 249, 250, 0.8);
        }

        /* Toast Notifications - Consistent Styling */
        .toast {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: none;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            border-left: 4px solid var(--accent);
        }

        .toast-header {
            background: rgba(255, 255, 255, 0.9);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 12px 12px 0 0;
        }

        /* Alert Boxes - Consistent Styling */
        .alert {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: none;
            border-radius: 12px;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--accent);
            padding: 1.25rem;
        }

        .alert-warning {
            border-left-color: var(--accent);
            background: rgba(212, 175, 55, 0.1);
        }

        .alert-success {
            border-left-color: #28a745;
            background: rgba(40, 167, 69, 0.1);
        }

        .alert-info {
            border-left-color: #17a2b8;
            background: rgba(23, 162, 184, 0.1);
        }

        .alert-danger {
            border-left-color: #dc3545;
            background: rgba(220, 53, 69, 0.1);
        }

        /* Prompt and Confirm Dialogs Styling */
        .custom-dialog {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: none;
            border-radius: 16px;
            box-shadow: var(--shadow-lg);
            padding: 2rem;
            border-top: 4px solid var(--accent);
        }

        /* Dropdown Menus - Consistent Styling */
        .dropdown-menu {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: none;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            border-top: 3px solid var(--accent);
            animation: fadeIn 0.2s ease;
        }

        .dropdown-item {
            padding: 0.75rem 1.25rem;
            transition: all 0.3s ease;
        }

        .dropdown-item:hover {
            background: rgba(26, 71, 42, 0.1);
            color: var(--primary);
        }

        /* Refresh Button Enhancement */
        #refresh-activities {
            transition: all 0.3s ease;
        }

        #refresh-activities:active {
            transform: rotate(180deg);
        }

        /* Loading States */
        .loading {
            position: relative;
            color: transparent !important;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .btn.loading {
            pointer-events: none;
        }

        /* Skeleton Loading */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 4px;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Help Tooltips */
        .help-tooltip {
            cursor: help;
            border-bottom: 1px dotted var(--text-light);
            position: relative;
        }

        .help-tooltip:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--text-dark);
            color: white;
            padding: 0.5rem 0.75rem;
            border-radius: 6px;
            font-size: 0.8rem;
            white-space: nowrap;
            z-index: 1000;
            box-shadow: var(--shadow);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .stats-card {
                padding: 1.5rem 1rem;
            }

            .stats-card h3 {
                font-size: 1.8rem;
            }

            .nav-tabs .nav-link {
                padding: 0.5rem 1rem;
                font-size: 0.875rem;
            }

            .container {
                padding-bottom: 80px;
            }
            
            /* Improved mobile footer spacing */
            .legal-footer {
                padding: 1.5rem 0;
            }
            
            .legal-footer .row {
                text-align: center;
            }
            
            .legal-footer .text-md-end {
                text-align: center !important;
                margin-top: 1rem;
            }
        }
        
        @media (max-width: 576px) {
            .profile-hero {
                padding: 2rem 1rem;
            }
            
            .profile-hero h1 {
                font-size: 1.8rem;
            }
            
            .profile-actions {
                flex-direction: column;
                align-items: center;
            }
            
            .profile-actions .btn {
                width: 100%;
                max-width: 250px;
            }
        }

        .share-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 20px;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            color: var(--text-light);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            border: none;
        }
        .share-btn:hover {
            background: white;
            color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .members-modal .member-status-paid {
            color: #28a745;
            font-weight: 600;
        }

        .members-modal .member-status-overdue {
            color: #dc3545;
            font-weight: 600;
        }

        .members-modal .member-status-pending {
            color: #ffc107;
            font-weight: 600;
        }

        .members-modal .progress {
            height: 8px;
        }

        .member-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        /* Action buttons styling */
        .action-buttons .btn {
            margin: 0 2px;
            transition: all 0.3s ease;
        }

        .action-buttons .btn:hover {
            transform: translateY(-2px);
        }
        
        /* Improved Group Name Layout */
        .group-header {
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .group-avatar {
            flex-shrink: 0;
        }

        .group-info {
            flex: 1;
            min-width: 0;
        }

        .group-title {
            margin-bottom: 4px;
        }

        .group-meta {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }

        .group-plan {
            font-size: 0.7rem;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
        }

        .member-count-link {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.875rem;
        }

        .member-count-link:hover {
            color: var(--accent);
            text-decoration: underline;
        }

        .group-created {
            font-size: 0.8rem;
            color: var(--text-light);
        }

        /* Make all badges in group meta smaller */
        .group-meta .badge {
            font-size: 0.7rem;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-weight: 500;
        }
        
        /* Profile Container - Match Navbar Width */
        .profile-container {
            width: 100%;
            padding: 0 15px;
            margin: 0 auto;
        }

        /* Use Bootstrap container breakpoints to match navbar */
        @media (min-width: 576px) {
            .profile-container {
                max-width: 540px;
            }
        }

        @media (min-width: 768px) {
            .profile-container {
                max-width: 720px;
            }
        }

        @media (min-width: 992px) {
            .profile-container {
                max-width: 960px;
            }
        }

        @media (min-width: 1200px) {
            .profile-container {
                max-width: 1140px;
            }
        }

        @media (min-width: 1400px) {
            .profile-container {
                max-width: 1320px;
            }
        }

        /* Make Profile Sections More Compact */
        .profile-combined-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            box-shadow: var(--shadow);
            backdrop-filter: blur(10px);
            overflow: hidden;
            margin-top: 1rem;
            margin-bottom: 2rem;
        }

        /* Hero Section - Make it pop */
        .profile-hero {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            padding: 3rem 2rem;
            text-align: center;
            margin-bottom: 0;
        }

        .profile-avatar-container {
            position: relative;
            display: inline-block;
            margin-bottom: 1.5rem;
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 4px solid white;
            box-shadow: var(--shadow-lg);
        }

        .avatar-upload {
            position: absolute;
            bottom: 5px;
            right: 5px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow);
            font-size: 0.9rem;
        }

        .avatar-upload:hover {
            background: var(--accent-light);
            transform: scale(1.1);
        }

        .profile-hero h1 {
            margin-bottom: 0.5rem;
            font-size: 2.2rem;
            font-weight: 700;
        }

        .profile-hero .title {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 1.5rem;
        }

        .welcome-name {
            color: var(--accent-light);
        }

        /* Profile Actions */
        .profile-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 1.5rem;
        }

        /* Compact Profile Content */
        .profile-content {
            padding: 2rem;
        }

        .profile-section {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid #e9ecef;
        }

        .profile-section:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        /* Compact Section Headers */
        .personal-info-section,
        .security-preferences-section {
            padding: 0;
        }

        .equal-height-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .equal-height-card {
            background: rgba(248, 249, 250, 0.8);
            border-radius: 12px;
            padding: 1.5rem;
            border-left: 4px solid var(--accent);
            min-height: 220px;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            transition: all 0.3s ease;
        }

        .equal-height-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        .equal-height-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
            flex: 1;
        }

        .equal-height-item:last-child {
            border-bottom: none;
        }

        .equal-height-label {
            font-weight: 600;
            color: var(--text-dark);
            font-size: 0.9rem;
            flex: 1;
            margin-right: 1rem;
        }

        .equal-height-value {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex-shrink: 0;
        }

        /* Form Switch Styling with Proper Spacing */
        .equal-height-value .form-check {
            margin-bottom: 0;
            min-width: 60px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .equal-height-value .form-check-input {
            width: 2.8em;
            height: 1.4em;
            margin-right: 0;
        }

        .equal-height-value .form-check-label {
            font-size: 0.85rem;
            color: var(--text-light);
            white-space: nowrap;
        }

        /* Personal Info Specific Adjustments - FIXED HEIGHT */
        .personal-info-item {
            display: flex;
            flex-direction: column;
            padding: 0.75rem 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
            flex: 1;
            min-height: 60px;
            justify-content: center;
        }

        .personal-info-item:last-child {
            border-bottom: none;
        }

        .personal-info-label {
            font-weight: 600;
            color: var(--text-dark);
            font-size: 0.85rem;
            margin-bottom: 0.25rem;
        }

        .personal-info-value {
            color: var(--text-light);
            font-size: 0.9rem;
            line-height: 1.3;
        }

        /* Security Preferences Specific Adjustments - FIXED HEIGHT */
        .security-preference-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
            flex: 1;
            min-height: 60px;
        }

        .security-preference-item:last-child {
            border-bottom: none;
        }

        .security-preference-label {
            font-weight: 600;
            color: var(--text-dark);
            font-size: 0.9rem;
            flex: 1;
            margin-right: 1rem;
        }

        .security-preference-value {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex-shrink: 0;
        }

        /* Button and Badge Spacing */
        .equal-height-value .btn {
            white-space: nowrap;
            padding: 0.375rem 0.75rem;
            font-size: 0.875rem;
            min-width: 80px;
        }

        .equal-height-value .badge {
            margin-right: 0.5rem;
            min-width: 60px;
            text-align: center;
        }

        /* Ensure consistent spacing for all content */
        .equal-height-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-around;
        }

        /* Section Headers */
        .section-header {
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--primary);
            margin: 0;
        }

        .section-title i {
            color: var(--accent);
        }

        /* Edit Form Styling */
        .edit-form {
            display: none;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .info-card {
            background: rgba(248, 249, 250, 0.8);
            border-radius: 12px;
            padding: 1.5rem;
            border-left: 4px solid var(--accent);
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 1.5rem;
            grid-column: 1 / -1;
        }

        /* Help Text Styling */
        .help-text {
            font-size: 0.8rem;
            color: var(--text-light);
            margin-top: 0.25rem;
        }

        /* Legal Notice Enhanced */
        .legal-notice-enhanced {
            border-left: 4px solid var(--accent);
            background: rgba(212, 175, 55, 0.05);
        }

        /* Empty States */
        .empty-state {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--text-light);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: var(--primary-light);
        }

        /* Focus States */
        .btn:focus,
        .form-control:focus,
        .form-select:focus {
            box-shadow: 0 0 0 3px rgba(26, 71, 42, 0.25);
            border-color: var(--primary);
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .personal-info-section,
            .security-preferences-section {
                padding: 0;
            }
            
            .profile-content {
                padding: 1.5rem;
            }
            
            .equal-height-card {
                min-height: 200px;
                padding: 1.25rem;
            }
            
            .security-preference-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
                text-align: left;
                min-height: 70px;
            }
            
            .security-preference-label {
                margin-right: 0;
                margin-bottom: 0.5rem;
            }
            
            .security-preference-value {
                width: 100%;
                justify-content: space-between;
            }
            
            .equal-height-value .form-check {
                min-width: auto;
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .form-actions .btn {
                width: 100%;
            }
        }

        /* Ultra Compact Option */
        .ultra-compact .equal-height-card {
            min-height: 180px;
            padding: 1rem;
        }

        .ultra-compact .equal-height-item,
        .ultra-compact .personal-info-item,
        .ultra-compact .security-preference-item {
            padding: 0.5rem 0;
        }
    </style>
</head>
<body>
    <!-- Main content wrapper -->
    <div class="main-content">
        <!-- Premium Navigation -->
        <nav class="navbar navbar-expand-lg navbar-light sticky-top">
            <div class="container">
                <div class="logo-container">
                    <div class="logo-icon">
                        <i class="fas fa-piggy-bank"></i>
                    </div>
                    <h1 class="logo-text">Stokvel Pro</h1>
                </div>
                
                <div class="navbar-nav ms-auto align-items-center flex-row">
                    <!-- Notifications -->
                    <div class="nav-item position-relative me-3">
                        <a class="nav-link" href="#" id="notification-bell">
                            <i class="fas fa-bell fs-5"></i>
                            <span class="notification-badge" id="navbar-notification-count">3</span>
                        </a>
                    </div>

                    <!-- User Menu -->
                    <div class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown">
                            <img src="https://ui-avatars.com/api/?name=Thabo+Mbeki&background=1a472a&color=FFFFFF" class="avatar" alt="Thabo Mbeki">
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><h6 class="dropdown-header">Welcome back, Thabo!</h6></li>
                            <li><a class="dropdown-item" href="#"><i class="fas fa-user me-2"></i>My Profile</a></li>
                            <li><a class="dropdown-item" href="#"><i class="fas fa-cog me-2"></i>Account Settings</a></li>
                            <li><a class="dropdown-item" href="#"><i class="fas fa-question-circle me-2"></i>Help & Support</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item text-danger" href="#" onclick="confirmLogout()"><i class="fas fa-sign-out-alt me-2"></i>Sign Out</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <div class="container mt-4">
            <!-- Desktop Tabs -->
            <div class="d-none d-md-block mb-4">
                <ul class="nav nav-tabs" id="desktopTabs">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" data-tab="home-tab">
                            <i class="fas fa-home me-2"></i>Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-tab="groups-tab">
                            <i class="fas fa-users me-2"></i>My Groups
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-tab="notifications-tab">
                            <i class="fas fa-bell me-2"></i>Notifications
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-tab="profile-tab">
                            <i class="fas fa-user me-2"></i>My Profile
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Tab Contents -->
            <div class="tab-content-container">
                <!-- Home Tab -->
                <div id="home-tab" class="tab-content active fade-in">
                    <!-- Enhanced Legal Notice -->
                    <div class="alert alert-warning alert-dismissible fade show legal-notice-enhanced" id="legal-notice">
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-shield-alt fa-2x me-3"></i>
                            <div>
                                <h6 class="mb-1"><strong>Important Regulatory Notice</strong></h6>
                                <p class="mb-0">Stokvel Pro is a financial management software platform only. We do not handle member funds, provide financial advice, or act as a financial institution.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Welcome Message -->
                    <div class="alert alert-info mb-4">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-info-circle fa-lg me-3"></i>
                            <div>
                                <h6 class="mb-1">Welcome to your Stokvel Pro Dashboard</h6>
                                <p class="mb-0">Track your savings groups, monitor contributions, and manage your stokvel activities all in one place.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Stats Overview -->
                    <div class="row g-4 mb-4">
                        <div class="col-xl-3 col-md-6">
                            <div class="stats-card">
                                <div class="card-body">
                                    <div class="icon">
                                        <i class="fas fa-users"></i>
                                    </div>
                                    <h3>248</h3>
                                    <p>Total Members</p>
                                    <div class="text-success small">
                                        <i class="fas fa-arrow-up me-1"></i> 12% increase
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xl-3 col-md-6">
                            <div class="stats-card accent">
                                <div class="card-body">
                                    <div class="icon">
                                        <i class="fas fa-money-bill-wave"></i>
                                    </div>
                                    <h3>R186,420</h3>
                                    <p>Total Group Savings</p>
                                    <div class="text-warning small">
                                        <i class="fas fa-arrow-up me-1"></i> 8% growth
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xl-3 col-md-6">
                            <div class="stats-card">
                                <div class="card-body">
                                    <div class="icon">
                                        <i class="fas fa-layer-group"></i>
                                    </div>
                                    <h3>14</h3>
                                    <p>Active Groups</p>
                                    <div class="text-success small">
                                        <i class="fas fa-arrow-up me-1"></i> 2 new groups
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xl-3 col-md-6">
                            <div class="stats-card accent">
                                <div class="card-body">
                                    <div class="icon">
                                        <i class="fas fa-calendar-check"></i>
                                    </div>
                                    <h3>7</h3>
                                    <p>Upcoming Events</p>
                                    <div class="text-warning small">
                                        Next: Tomorrow
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row g-4">
                        <!-- Recent Activity -->
                        <div class="col-lg-8">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <div>
                                        <h5 class="mb-0"><i class="fas fa-clock me-2"></i>Recent Group Activity</h5>
                                        <small class="text-muted">Latest updates from your stokvel groups</small>
                                    </div>
                                    <button class="btn btn-sm btn-outline-primary" id="refresh-activities">
                                        <i class="fas fa-sync-alt me-1"></i>Refresh
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div class="activity-list" id="activity-list">
                                        <!-- Activities will be loaded here -->
                                        <div class="activity-item">
                                            <div class="d-flex justify-content-between align-items-start">
                                                <div class="d-flex align-items-center">
                                                    <div class="avatar-sm bg-primary rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px;">
                                                        <i class="fas fa-money-bill-wave text-white"></i>
                                                    </div>
                                                    <div>
                                                        <p class="mb-1 fw-semibold">Sarah Johnson contributed R1,500 to Investment Club</p>
                                                        <small class="text-muted"><i class="fas fa-clock me-1"></i>2 hours ago • Monthly contribution</small>
                                                    </div>
                                                </div>
                                                <span class="badge bg-accent">Contribution</span>
                                            </div>
                                            <div class="activity-actions mt-3">
                                                <button class="action-btn like-btn">
                                                    <i class="far fa-heart"></i> <span class="like-count">8</span>
                                                </button>
                                                <button class="action-btn comment-btn">
                                                    <i class="far fa-comment"></i> <span class="comment-count">3</span>
                                                </button>
                                                <button class="action-btn share-btn">
                                                    <i class="fas fa-share"></i> Share
                                                </button>
                                            </div>
                                        </div>

                                        <div class="activity-item">
                                            <div class="d-flex justify-content-between align-items-start">
                                                <div class="d-flex align-items-center">
                                                    <div class="avatar-sm bg-accent rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px;">
                                                        <i class="fas fa-user-plus text-white"></i>
                                                    </div>
                                                    <div>
                                                        <p class="mb-1 fw-semibold">David Mokoena joined Savings Group</p>
                                                        <small class="text-muted"><i class="fas fa-clock me-1"></i>5 hours ago • New member</small>
                                                    </div>
                                                </div>
                                                <span class="badge bg-primary">Membership</span>
                                            </div>
                                            <div class="activity-actions mt-3">
                                                <button class="action-btn like-btn">
                                                    <i class="far fa-heart"></i> <span class="like-count">12</span>
                                                </button>
                                                <button class="action-btn comment-btn">
                                                    <i class="far fa-comment"></i> <span class="comment-count">5</span>
                                                </button>
                                                <button class="action-btn share-btn">
                                                    <i class="fas fa-share"></i> Share
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div class="col-lg-4">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0"><i class="fas fa-bolt me-2"></i>Quick Actions</h5>
                                    <small class="text-muted">Frequently used tasks</small>
                                </div>
                                <div class="card-body">
                                    <div class="d-grid gap-2">
                                        <button class="btn btn-primary mb-2 quick-action-btn" id="create-group-btn">
                                            <i class="fas fa-plus-circle me-2"></i>Create New Group
                                        </button>
                                        <button class="btn btn-outline-primary mb-2 quick-action-btn" id="record-payment-btn">
                                            <i class="fas fa-money-bill-wave me-2"></i>Record Contribution
                                        </button>
                                        <button class="btn btn-outline-primary mb-2 quick-action-btn" id="add-member-btn">
                                            <i class="fas fa-user-plus me-2"></i>Add Member
                                        </button>
                                        <button class="btn btn-outline-primary quick-action-btn" id="schedule-event-btn">
                                            <i class="fas fa-calendar-plus me-2"></i>Schedule Meeting
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Member Limits -->
                            <div class="card mt-4">
                                <div class="card-header">
                                    <h5 class="mb-0"><i class="fas fa-chart-pie me-2"></i>Group Capacity</h5>
                                    <small class="text-muted">Monitor your group membership limits</small>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label class="form-label fw-semibold">Select Group to View</label>
                                        <select class="form-select" id="group-select">
                                            <option value="">Choose a stokvel group...</option>
                                            <option value="1">Investment Club (45/50 members)</option>
                                            <option value="2">Savings Group (28/30 members)</option>
                                            <option value="3">Emergency Fund (15/20 members)</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <div class="d-flex justify-content-between mb-2">
                                            <small class="fw-semibold">Current Usage: 45/50 members</small>
                                            <small class="fw-semibold">90% capacity</small>
                                        </div>
                                        <div class="usage-bar">
                                            <div class="usage-fill" style="width: 90%;"></div>
                                        </div>
                                    </div>
                                    <div class="alert alert-warning">
                                        <i class="fas fa-exclamation-triangle me-2"></i>
                                        <strong>Approaching group limit</strong> - Consider upgrading your plan
                                    </div>
                                    <button class="btn btn-accent w-100" id="upgrade-plan-btn">
                                        <i class="fas fa-crown me-2"></i>Upgrade Membership Plan
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Groups Tab -->
                <div id="groups-tab" class="tab-content fade-in">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <div>
                                <h4 class="mb-0"><i class="fas fa-users me-2"></i>My Stokvel Groups</h4>
                                <small class="text-muted">Manage and monitor all your savings groups</small>
                            </div>
                            <button class="btn btn-primary" id="add-group-btn">
                                <i class="fas fa-plus me-2"></i>Add New Group
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>Group Details</th>
                                            <th>Next Payout</th>
                                            <th>Payment Due</th>
                                            <th>Total Savings</th>
                                            <th>Status</th>
                                            <th>Next Meeting</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>
                                                <div class="group-header">
                                                    <div class="group-avatar">
                                                        <div class="avatar-sm bg-primary rounded-circle d-flex align-items-center justify-content-center" style="width: 45px; height: 45px;">
                                                            <i class="fas fa-chart-line text-white"></i>
                                                        </div>
                                                    </div>
                                                    <div class="group-info">
                                                        <div class="group-title">
                                                            <strong class="d-block">Investment Club</strong>
                                                        </div>
                                                        <div class="group-meta">
                                                            <span class="badge bg-accent">Premium Plan</span>
                                                            <span class="member-count-link" data-group="investment-club">
                                                                45/50 members
                                                            </span>
                                                        </div>
                                                        <div class="group-created mt-1">
                                                            <small class="text-muted">Established: Jan 15, 2024</small>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="fw-semibold">Sarah Johnson</div>
                                                <small class="text-muted">Rotation #12</small>
                                            </td>
                                            <td>
                                                <div class="fw-semibold">Mar 15, 2024</div>
                                                <small class="text-warning"><i class="fas fa-clock me-1"></i>3 days remaining</small>
                                            </td>
                                            <td>
                                                <strong>R85,250</strong>
                                                <div class="text-success small">
                                                    <i class="fas fa-arrow-up me-1"></i> 15% growth
                                                </div>
                                            </td>
                                            <td><span class="badge bg-primary">Active</span></td>
                                            <td>
                                                <div>Mar 20, 2024</div>
                                                <small class="text-muted">Monthly meeting</small>
                                            </td>
                                            <td>
                                                <div class="action-buttons">
                                                    <button class="btn btn-sm btn-outline-primary view-group-btn" data-group="investment-club">
                                                        <i class="fas fa-eye"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-outline-secondary edit-group-btn" data-group="investment-club">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-outline-danger archive-group-btn" data-group="investment-club">
                                                        <i class="fas fa-archive"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Notifications Tab -->
                <div id="notifications-tab" class="tab-content fade-in">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <div>
                                <h4 class="mb-0"><i class="fas fa-bell me-2"></i>Notifications & Alerts</h4>
                                <small class="text-muted">Stay updated on your stokvel activities</small>
                            </div>
                            <div>
                                <button class="btn btn-sm btn-outline-primary me-2" id="mark-all-read">
                                    <i class="fas fa-check-double me-1"></i>Mark All Read
                                </button>
                                <button class="btn btn-sm btn-outline-secondary">
                                    <i class="fas fa-cog me-1"></i>Settings
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="list-group" id="notifications-list">
                                <a href="#" class="list-group-item list-group-item-action">
                                    <div class="d-flex w-100 justify-content-between">
                                        <h6 class="mb-1">
                                            <i class="fas fa-money-bill-wave text-success me-2"></i>
                                            Contribution Received
                                        </h6>
                                        <small class="text-muted">2 hours ago</small>
                                    </div>
                                    <p class="mb-1">Sarah Johnson made her monthly contribution of R1,500 to Investment Club</p>
                                    <small class="text-muted"><i class="fas fa-circle text-success me-1"></i>Unread</small>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Profile Tab -->
                <div id="profile-tab" class="tab-content fade-in">
                    <div class="profile-container">
                        <!-- Combined Profile Container -->
                        <div class="profile-combined-container">
                            <!-- Avatar Hero Section -->
                            <div class="profile-hero">
                                <div class="profile-avatar-container">
                                    <img src="https://ui-avatars.com/api/?name=Thabo+Mbeki&background=1a472a&color=FFFFFF&size=140" class="profile-avatar" id="profile-avatar" alt="Thabo Mbeki">
                                    <button class="avatar-upload" id="avatar-upload-btn">
                                        <i class="fas fa-camera"></i>
                                    </button>
                                    <input type="file" id="avatar-upload-input" accept="image/*" style="display: none;">
                                </div>
                                
                                <h1>Welcome, <span class="welcome-name" id="welcome-name">Thabo Mbeki</span>!</h1>
                                <p class="title">Stokvel Administrator & Group Coordinator</p>
                                
                                <div class="profile-actions">
                                    <button class="btn btn-primary" id="edit-profile-btn">
                                        <i class="fas fa-edit me-2"></i>Edit Profile
                                    </button>
                                    <button class="btn btn-outline-light" id="change-password-btn">
                                        <i class="fas fa-key me-2"></i>Change Password
                                    </button>
                                </div>
                            </div>

                            <!-- Profile Content Sections -->
                            <div class="profile-content">
                                <!-- Personal Information Section -->
                                <div class="profile-section compact-section personal-info-section">
                                    <div class="section-header">
                                        <i class="fas fa-user-circle fa-lg"></i>
                                        <h3 class="section-title">Personal Information</h3>
                                    </div>
                                    
                                    <div class="equal-height-grid" id="personal-info-view">
                                        <div class="equal-height-card">
                                            <div class="equal-height-content">
                                                <div class="personal-info-item">
                                                    <div class="personal-info-label">Full Name</div>
                                                    <div class="personal-info-value" id="view-full-name">Thabo Mbeki</div>
                                                </div>
                                                <div class="personal-info-item">
                                                    <div class="personal-info-label">Email Address</div>
                                                    <div class="personal-info-value" id="view-email">thabo.mbeki@stokvelpro.co.za</div>
                                                </div>
                                                <div class="personal-info-item">
                                                    <div class="personal-info-label">Phone Number</div>
                                                    <div class="personal-info-value" id="view-phone">+27 11 234 5678</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="equal-height-card">
                                            <div class="equal-height-content">
                                                <div class="personal-info-item">
                                                    <div class="personal-info-label">Member Since</div>
                                                    <div class="personal-info-value" id="view-member-since">January 15, 2023</div>
                                                </div>
                                                <div class="personal-info-item">
                                                    <div class="personal-info-label">Account Status</div>
                                                    <div class="personal-info-value"><span class="badge bg-primary">Verified</span></div>
                                                </div>
                                                <div class="personal-info-item">
                                                    <div class="personal-info-label">Last Login</div>
                                                    <div class="personal-info-value">Today, 14:30</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Edit Mode -->
                                    <div class="edit-form" id="personal-info-edit" style="display: none;">
                                        <div class="info-card">
                                            <div class="form-group">
                                                <label class="form-label fw-semibold">Full Name</label>
                                                <input type="text" class="form-control" id="edit-full-name" value="Thabo Mbeki">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label fw-semibold">Email Address</label>
                                                <input type="email" class="form-control" id="edit-email" value="thabo.mbeki@stokvelpro.co.za">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label fw-semibold">Phone Number</label>
                                                <input type="tel" class="form-control" id="edit-phone" value="+27 11 234 5678">
                                            </div>
                                        </div>
                                        
                                        <div class="info-card">
                                            <div class="form-group">
                                                <label class="form-label fw-semibold">Profile Picture</label>
                                                <div class="d-flex align-items-center gap-3">
                                                    <img src="https://ui-avatars.com/api/?name=Thabo+Mbeki&background=1a472a&color=FFFFFF&size=80" id="edit-avatar-preview" class="rounded-circle" alt="Preview" style="width: 80px; height: 80px;">
                                                    <div>
                                                        <button type="button" class="btn btn-outline-primary btn-sm" id="change-avatar-btn">
                                                            <i class="fas fa-camera me-2"></i>Change Photo
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="form-actions">
                                            <button type="button" class="btn btn-outline-secondary" id="cancel-edit-btn">
                                                <i class="fas fa-times me-2"></i>Cancel
                                            </button>
                                            <button type="button" class="btn btn-success" id="save-profile-btn">
                                                <i class="fas fa-save me-2"></i>Save Changes
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Security & Preferences Section -->
                                <div class="profile-section compact-section security-preferences-section">
                                    <div class="section-header">
                                        <i class="fas fa-shield-alt fa-lg"></i>
                                        <h3 class="section-title">Security & Preferences</h3>
                                    </div>
                                    
                                    <div class="equal-height-grid">
                                        <div class="equal-height-card">
                                            <div class="equal-height-content">
                                                <div class="security-preference-item">
                                                    <div class="security-preference-label">Password Strength</div>
                                                    <div class="security-preference-value">
                                                        <span class="badge bg-success">Strong</span>
                                                    </div>
                                                </div>
                                                <div class="security-preference-item">
                                                    <div class="security-preference-label">Two-Factor Authentication</div>
                                                    <div class="security-preference-value">
                                                        <span class="badge bg-warning text-dark">Not Enabled</span>
                                                        <button class="btn btn-outline-primary btn-sm">Enable</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="equal-height-card">
                                            <div class="equal-height-content">
                                                <div class="security-preference-item">
                                                    <div class="security-preference-label">Email Notifications</div>
                                                    <div class="security-preference-value">
                                                        <div class="form-check form-switch">
                                                            <input class="form-check-input" type="checkbox" id="email-notifications" checked>
                                                            <label class="form-check-label" for="email-notifications">Enabled</label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="security-preference-item">
                                                    <div class="security-preference-label">SMS Alerts</div>
                                                    <div class="security-preference-value">
                                                        <div class="form-check form-switch">
                                                            <input class="form-check-input" type="checkbox" id="sms-alerts" checked>
                                                            <label class="form-check-label" for="sms-alerts">Enabled</label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer - FIXED -->
    <footer class="legal-footer">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <div class="d-flex align-items-center">
                        <div class="logo-icon me-3">
                            <i class="fas fa-piggy-bank"></i>
                        </div>
                        <div>
                            <h5 class="mb-1">Stokvel Pro</h5>
                            <p class="text-muted small mb-0">Empowering Community Savings & Financial Management</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 text-md-end">
                    <div class="mt-3 mt-md-0">
                        <span class="badge bg-primary me-2">FSCA Registered</span>
                        <span class="badge bg-accent me-2">POPIA Compliant</span>
                        <span class="badge bg-success me-2">Secure & Encrypted</span>
                        <span class="text-muted small d-block mt-2">© 2024 Stokvel Pro PTY Ltd. All rights reserved.</span>
                    </div>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-12 text-center">
                    <small class="text-muted">
                        Stokvel Pro is a financial management platform only. We do not handle member funds or provide financial advice. 
                        <a href="#" class="text-white-50">Terms of Service</a> • 
                        <a href="#" class="text-white-50">Privacy Policy</a> • 
                        <a href="#" class="text-white-50">Compliance Information</a>
                    </small>
                </div>
            </div>
        </div>
    </footer>


    <!-- Bottom Navigation (Mobile) -->
    <nav class="bottom-nav d-md-none">
        <a href="#" class="nav-item active" data-tab="home-tab">
            <i class="fas fa-home nav-icon"></i>
            <span>Dashboard</span>
        </a>
        <a href="#" class="nav-item" data-tab="groups-tab">
            <i class="fas fa-users nav-icon"></i>
            <span>Groups</span>
        </a>
        <a href="#" class="nav-item" data-tab="notifications-tab">
            <i class="fas fa-bell nav-icon"></i>
            <span>Alerts</span>
        </a>
        <a href="#" class="nav-item" data-tab="profile-tab">
            <i class="fas fa-user nav-icon"></i>
            <span>Profile</span>
        </a>
    </nav>

    <!-- Bootstrap & Custom JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            setupTabNavigation();
            setupEventListeners();
            setupActivityButtons();
            setupQuickActions();
            setupShareButtons();
            setupGroupsPage();
            setupProfilePage();
            loadInitialData();
            
            console.log('Stokvel Pro Premium initialized successfully');
        }

        function setupTabNavigation() {
            // Desktop tabs
            const desktopTabs = document.querySelectorAll('#desktopTabs .nav-link');
            desktopTabs.forEach(tab => {
                tab.addEventListener('click', function(e) {
                    e.preventDefault();
                    const tabId = this.getAttribute('data-tab');
                    switchTab(tabId);
                });
            });

            // Mobile tabs
            const mobileTabs = document.querySelectorAll('.bottom-nav .nav-item');
            mobileTabs.forEach(tab => {
                tab.addEventListener('click', function(e) {
                    e.preventDefault();
                    const tabId = this.getAttribute('data-tab');
                    switchTab(tabId);
                });
            });
        }

        function switchTab(tabId) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab
            const selectedTab = document.getElementById(tabId);
            if (selectedTab) {
                selectedTab.classList.add('active');
            }

            // Update active states
            document.querySelectorAll('#desktopTabs .nav-link').forEach(tab => {
                tab.classList.remove('active');
                if (tab.getAttribute('data-tab') === tabId) {
                    tab.classList.add('active');
                }
            });

            document.querySelectorAll('.bottom-nav .nav-item').forEach(tab => {
                tab.classList.remove('active');
                if (tab.getAttribute('data-tab') === tabId) {
                    tab.classList.add('active');
                }
            });
        }

        function setupEventListeners() {
            // Refresh activities button
            const refreshBtn = document.getElementById('refresh-activities');
            if (refreshBtn) {
                refreshBtn.addEventListener('click', function() {
                    refreshActivities();
                });
            }

            // Notification bell
            const notificationBell = document.getElementById('notification-bell');
            if (notificationBell) {
                notificationBell.addEventListener('click', function(e) {
                    e.preventDefault();
                    switchTab('notifications-tab');
                });
            }

            // Group select change
            const groupSelect = document.getElementById('group-select');
            if (groupSelect) {
                groupSelect.addEventListener('change', function() {
                    if (this.value) {
                        simulateLoading(() => {
                            showToast(`Now viewing ${this.options[this.selectedIndex].text}`, 'info');
                        }, 800);
                    }
                });
            }

            // Legal notice close button
            const legalNotice = document.getElementById('legal-notice');
            if (legalNotice) {
                const closeBtn = legalNotice.querySelector('.btn-close');
                closeBtn.addEventListener('click', function() {
                    legalNotice.classList.add('fade-out');
                    setTimeout(() => {
                        legalNotice.style.display = 'none';
                    }, 300);
                });
            }

            // Upgrade plan button
            const upgradeBtn = document.getElementById('upgrade-plan-btn');
            if (upgradeBtn) {
                upgradeBtn.addEventListener('click', function() {
                    simulateLoading(() => {
                        showEnhancedPopup('Upgrade Membership Plan', 'Explore our Premium and Business plans for larger groups and advanced features.', 'info');
                    }, 1000);
                });
            }

            // Add group button
            const addGroupBtn = document.getElementById('add-group-btn');
            if (addGroupBtn) {
                addGroupBtn.addEventListener('click', function() {
                    showEnhancedPopup('Create New Stokvel Group', 'Start a new savings group with custom settings and member management.', 'info');
                });
            }

            // Mark all notifications as read
            const markAllReadBtn = document.getElementById('mark-all-read');
            if (markAllReadBtn) {
                markAllReadBtn.addEventListener('click', function() {
                    const notifications = document.querySelectorAll('#notifications-list .list-group-item');
                    notifications.forEach(notification => {
                        const statusBadge = notification.querySelector('.text-success');
                        if (statusBadge) {
                            statusBadge.innerHTML = '<i class="fas fa-circle text-muted me-1"></i>Read';
                        }
                    });
                    showToast('All notifications marked as read', 'success');
                });
            }
        }

        // Enhanced Quick Action Buttons
        function setupQuickActions() {
            const quickActions = {
                'create-group-btn': {
                    title: 'Create New Stokvel Group',
                    message: 'Start a new savings group with custom settings and member management.',
                    type: 'info'
                },
                'record-payment-btn': {
                    title: 'Record Member Contribution', 
                    message: 'Log a member payment with amount, date, and payment method.',
                    type: 'info'
                },
                'add-member-btn': {
                    title: 'Add New Member',
                    message: 'Invite a new member to join your stokvel group.',
                    type: 'info'
                },
                'schedule-event-btn': {
                    title: 'Schedule Group Meeting',
                    message: 'Plan your next stokvel meeting with date, time, and location.',
                    type: 'info'
                }
            };

            Object.keys(quickActions).forEach(buttonId => {
                const btn = document.getElementById(buttonId);
                if (btn) {
                    btn.addEventListener('click', function() {
                        const action = quickActions[buttonId];
                        simulateLoading(() => {
                            showEnhancedPopup(action.title, action.message, action.type);
                        }, 800);
                    });
                }
            });
        }

        // Enhanced Popup Function
        function showEnhancedPopup(title, message, type = 'info') {
            // Create modal backdrop
            const backdrop = document.createElement('div');
            backdrop.className = 'modal-backdrop fade show';
            
            // Create modal
            const modal = document.createElement('div');
            modal.className = 'modal fade show';
            modal.style.display = 'block';
            modal.style.background = 'rgba(0,0,0,0.5)';
            
            modal.innerHTML = `
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">
                                <i class="fas fa-${getPopupIcon(type)} me-2"></i>
                                ${title}
                            </h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <p class="mb-0">${message}</p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-primary" id="confirm-popup">Continue</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(backdrop);
            document.body.appendChild(modal);
            
            // Add event listeners
            const confirmBtn = modal.querySelector('#confirm-popup');
            const closeBtn = modal.querySelector('.btn-close');
            
            const closeModal = () => {
                modal.classList.add('fade');
                backdrop.classList.add('fade');
                setTimeout(() => {
                    document.body.removeChild(modal);
                    document.body.removeChild(backdrop);
                }, 300);
            };
            
            confirmBtn.addEventListener('click', function() {
                showToast('Action completed successfully!', 'success');
                closeModal();
            });
            
            closeBtn.addEventListener('click', closeModal);
            
            // Close on backdrop click
            modal.addEventListener('click', (e) => {
                if (e.target === modal) closeModal();
            });
        }

        function getPopupIcon(type) {
            const icons = {
                'success': 'check-circle',
                'error': 'exclamation-triangle', 
                'warning': 'exclamation-circle',
                'info': 'info-circle'
            };
            return icons[type] || 'info-circle';
        }

        // Enhanced Share Function with Popup
        function setupShareButtons() {
            document.addEventListener('click', function(e) {
                if (e.target.closest('.share-btn')) {
                    const activityItem = e.target.closest('.activity-item');
                    const activityText = activityItem.querySelector('.fw-semibold').textContent;
                    
                    showEnhancedPopup(
                        'Share Activity Update',
                        `Share "${activityText}" with group members or export to social media?`,
                        'info'
                    );
                }
            });
        }

        function setupActivityButtons() {
            // Event delegation for activity buttons
            document.addEventListener('click', function(e) {
                // Like buttons
                if (e.target.closest('.like-btn')) {
                    const likeBtn = e.target.closest('.like-btn');
                    likeBtn.classList.toggle('liked');
                    const likeCount = likeBtn.querySelector('.like-count');
                    let count = parseInt(likeCount.textContent) || 0;
                    
                    if (likeBtn.classList.contains('liked')) {
                        count++;
                        likeBtn.innerHTML = '<i class="fas fa-heart"></i> ' + count;
                        showToast('Activity liked!', 'success');
                    } else {
                        count--;
                        likeBtn.innerHTML = '<i class="far fa-heart"></i> ' + count;
                    }
                }
                
                // Comment buttons
                if (e.target.closest('.comment-btn')) {
                    showEnhancedPopup(
                        'Add Comment',
                        'Share your thoughts on this activity with other group members.',
                        'info'
                    );
                }
            });
        }

        function refreshActivities() {
            const refreshBtn = document.getElementById('refresh-activities');
            const activityList = document.getElementById('activity-list');
            
            // Show loading state
            refreshBtn.disabled = true;
            refreshBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>Refreshing...';
            
            // Simulate API call
            setTimeout(() => {
                // Add a new activity
                const newActivity = document.createElement('div');
                newActivity.className = 'activity-item slide-in';
                newActivity.innerHTML = `
                    <div class="d-flex justify-content-between align-items-start">
                        <div class="d-flex align-items-center">
                            <div class="avatar-sm bg-success rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px;">
                                <i class="fas fa-gift text-white"></i>
                            </div>
                            <div>
                                <p class="mb-1 fw-semibold">Payout completed for Investment Club rotation #12</p>
                                <small class="text-muted"><i class="fas fa-clock me-1"></i>Just now • R15,000 distributed</small>
                            </div>
                        </div>
                        <span class="badge bg-success">Payout</span>
                    </div>
                    <div class="activity-actions mt-3">
                        <button class="action-btn like-btn">
                            <i class="far fa-heart"></i> <span class="like-count">0</span>
                        </button>
                        <button class="action-btn comment-btn">
                            <i class="far fa-comment"></i> <span class="comment-count">0</span>
                        </button>
                        <button class="action-btn share-btn">
                            <i class="fas fa-share"></i> Share
                        </button>
                    </div>
                `;
                
                // Add to top of activity list
                activityList.insertBefore(newActivity, activityList.firstChild);
                
                // Reset button
                refreshBtn.disabled = false;
                refreshBtn.innerHTML = '<i class="fas fa-sync-alt me-1"></i>Refresh';
                
                showToast('Activities updated!', 'success');
            }, 1500);
        }

        function loadInitialData() {
            // Simulate loading data
            setTimeout(() => {
                showToast('Welcome to Stokvel Pro, Thabo! Your dashboard is ready.', 'success');
            }, 1000);
        }

        function showToast(message, type = 'info') {
            // Create a simple toast notification
            const toast = document.createElement('div');
            toast.className = `position-fixed top-0 end-0 p-3`;
            toast.style.zIndex = '9999';
            
            const toastContent = document.createElement('div');
            toastContent.className = `toast align-items-center text-white bg-${type === 'success' ? 'success' : type === 'error' ? 'danger' : 'primary'} border-0`;
            toastContent.setAttribute('role', 'alert');
            
            toastContent.innerHTML = `
                <div class="d-flex">
                    <div class="toast-body">
                        <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-triangle' : 'info-circle'} me-2"></i>
                        ${message}
                    </div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
                </div>
            `;
            
            toast.appendChild(toastContent);
            document.body.appendChild(toast);
            
            const bsToast = new bootstrap.Toast(toastContent);
            bsToast.show();
            
            toastContent.addEventListener('hidden.bs.toast', () => {
                document.body.removeChild(toast);
            });
        }

        // Global functions
        function confirmLogout() {
            showEnhancedPopup(
                'Confirm Sign Out', 
                'Are you sure you want to sign out of Stokvel Pro? You will need to log in again to access your stokvel groups.',
                'warning'
            );
        }

        // Simulate loading with a callback
        function simulateLoading(callback, duration = 1000) {
            // You could show a loading spinner here if needed
            setTimeout(callback, duration);
        }
        
        // Groups Page Functionality
        function setupGroupsPage() {
            // Member count click handler
            document.querySelectorAll('.member-count-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const groupName = this.getAttribute('data-group');
                    showMembersModal(groupName);
                });
            });

            // Action buttons functionality
            document.querySelectorAll('.view-group-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const groupName = this.getAttribute('data-group');
                    showEnhancedPopup('View Group Details', `Viewing details for ${groupName.replace('-', ' ')}.`, 'info');
                });
            });

            document.querySelectorAll('.edit-group-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const groupName = this.getAttribute('data-group');
                    showEnhancedPopup('Edit Group Settings', `Modify settings for ${groupName.replace('-', ' ')}.`, 'info');
                });
            });

            document.querySelectorAll('.archive-group-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const groupName = this.getAttribute('data-group');
                    showEnhancedPopup('Archive Group', `Are you sure you want to archive ${groupName.replace('-', ' ')}?`, 'warning');
                });
            });
        }

        // Members Modal Function
        function showMembersModal(groupName) {
            const groupData = {
                'investment-club': {
                    name: 'Investment Club',
                    members: [
                        { name: 'Sarah Johnson', status: 'paid', amount: 'R1,500', date: 'Mar 10, 2024', avatar: 'SJ' },
                        { name: 'Mike Chen', status: 'paid', amount: 'R1,500', date: 'Mar 10, 2024', avatar: 'MC' },
                        { name: 'David Wilson', status: 'paid', amount: 'R1,500', date: 'Mar 10, 2024', avatar: 'DW' }
                    ],
                    stats: { paid: 3, overdue: 0, pending: 0, total: 3 }
                }
            };

            const group = groupData[groupName];
            if (!group) return;

            // Create modal backdrop
            const backdrop = document.createElement('div');
            backdrop.className = 'modal-backdrop fade show';
            
            // Create modal
            const modal = document.createElement('div');
            modal.className = 'modal fade show members-modal';
            modal.style.display = 'block';
            modal.style.background = 'rgba(0,0,0,0.5)';
            
            modal.innerHTML = `
                <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">
                                <i class="fas fa-users me-2"></i>
                                ${group.name} - Member Management
                            </h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <!-- Payment Statistics -->
                            <div class="row mb-4">
                                <div class="col-md-4">
                                    <div class="card bg-success bg-opacity-10 border-success">
                                        <div class="card-body text-center">
                                            <h3 class="text-success">${group.stats.paid}</h3>
                                            <p class="mb-0 text-success">Paid Members</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card bg-danger bg-opacity-10 border-danger">
                                        <div class="card-body text-center">
                                            <h3 class="text-danger">${group.stats.overdue}</h3>
                                            <p class="mb-0 text-danger">Overdue Payments</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card bg-warning bg-opacity-10 border-warning">
                                        <div class="card-body text-center">
                                            <h3 class="text-warning">${group.stats.pending}</h3>
                                            <p class="mb-0 text-warning">Pending Contributions</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Progress Bar -->
                            <div class="mb-4">
                                <div class="d-flex justify-content-between mb-2">
                                    <span>Payment Completion Rate</span>
                                    <span>${Math.round((group.stats.paid / group.stats.total) * 100)}%</span>
                                </div>
                                <div class="progress">
                                    <div class="progress-bar bg-success" style="width: ${(group.stats.paid / group.stats.total) * 100}%"></div>
                                </div>
                            </div>

                            <!-- Members List -->
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>Member</th>
                                            <th>Payment Status</th>
                                            <th>Amount Due</th>
                                            <th>Due Date</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${group.members.map(member => `
                                            <tr>
                                                <td>
                                                    <div class="d-flex align-items-center">
                                                        <div class="avatar-sm bg-primary rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 35px; height: 35px;">
                                                            <span class="text-white small fw-bold">${member.avatar}</span>
                                                        </div>
                                                        <div>${member.name}</div>
                                                    </div>
                                                </td>
                                                <td>
                                                    <span class="member-status-${member.status}">
                                                        <i class="fas fa-${member.status === 'paid' ? 'check-circle' : member.status === 'overdue' ? 'exclamation-triangle' : 'clock'} me-1"></i>
                                                        ${member.status.charAt(0).toUpperCase() + member.status.slice(1)}
                                                    </span>
                                                </td>
                                                <td class="fw-semibold">${member.amount}</td>
                                                <td>${member.date}</td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-primary" onclick="showMemberDetails('${member.name}')">
                                                        <i class="fas fa-eye"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-outline-success" onclick="recordPayment('${member.name}')">
                                                        <i class="fas fa-money-bill-wave"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" id="close-members-modal">Close</button>
                            <button type="button" class="btn btn-primary" onclick="exportMemberReport('${groupName}')">
                                <i class="fas fa-download me-2"></i>Export Report
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(backdrop);
            document.body.appendChild(modal);
            
            // Add event listeners
            const closeBtn = modal.querySelector('#close-members-modal');
            const closeX = modal.querySelector('.btn-close');
            
            const closeModal = () => {
                modal.classList.add('fade');
                backdrop.classList.add('fade');
                setTimeout(() => {
                    document.body.removeChild(modal);
                    document.body.removeChild(backdrop);
                }, 300);
            };
            
            closeBtn.addEventListener('click', closeModal);
            closeX.addEventListener('click', closeModal);
            
            // Close on backdrop click
            modal.addEventListener('click', (e) => {
                if (e.target === modal) closeModal();
            });
        }

        // Additional member functions
        function showMemberDetails(memberName) {
            showEnhancedPopup(
                `Member Profile - ${memberName}`,
                `View detailed information about ${memberName}.`,
                'info'
            );
        }

        function recordPayment(memberName) {
            showEnhancedPopup(
                `Record Payment - ${memberName}`,
                `Log a payment from ${memberName}.`,
                'info'
            );
        }

        function exportMemberReport(groupName) {
            showToast(`Exporting member report for ${groupName.replace('-', ' ')}...`, 'success');
        }
        
        function setupProfilePage() {
            const editBtn = document.getElementById('edit-profile-btn');
            const saveBtn = document.getElementById('save-profile-btn');
            const cancelBtn = document.getElementById('cancel-edit-btn');
            const avatarUploadBtn = document.getElementById('avatar-upload-btn');
            const avatarUploadInput = document.getElementById('avatar-upload-input');
            const changeAvatarBtn = document.getElementById('change-avatar-btn');

            // Edit Profile Button
            if (editBtn) {
                editBtn.addEventListener('click', enterEditMode);
            }

            // Save Profile Button
            if (saveBtn) {
                saveBtn.addEventListener('click', saveProfile);
            }

            // Cancel Edit Button
            if (cancelBtn) {
                cancelBtn.addEventListener('click', exitEditMode);
            }

            // Avatar Upload - Main Button
            if (avatarUploadBtn) {
                avatarUploadBtn.addEventListener('click', function() {
                    avatarUploadInput.click();
                });
            }

            // Avatar Upload - Change Button in Edit Mode
            if (changeAvatarBtn) {
                changeAvatarBtn.addEventListener('click', function() {
                    avatarUploadInput.click();
                });
            }

            // Handle Avatar Upload
            if (avatarUploadInput) {
                avatarUploadInput.addEventListener('change', function(e) {
                    if (e.target.files && e.target.files[0]) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            // Update all avatar instances
                            const profileAvatar = document.getElementById('profile-avatar');
                            const editAvatarPreview = document.getElementById('edit-avatar-preview');
                            
                            if (profileAvatar) profileAvatar.src = e.target.result;
                            if (editAvatarPreview) editAvatarPreview.src = e.target.result;
                            
                            showToast('Profile picture updated successfully!', 'success');
                        };
                        reader.readAsDataURL(e.target.files[0]);
                    }
                });
            }

            // Change Password Button
            const changePasswordBtn = document.getElementById('change-password-btn');
            if (changePasswordBtn) {
                changePasswordBtn.addEventListener('click', function() {
                    showEnhancedPopup(
                        'Change Password',
                        'Update your account password for enhanced security.',
                        'info'
                    );
                });
            }
        }

        function enterEditMode() {
            // Show edit form, hide view
            const personalInfoView = document.getElementById('personal-info-view');
            const personalInfoEdit = document.getElementById('personal-info-edit');
            
            if (personalInfoView) personalInfoView.style.display = 'none';
            if (personalInfoEdit) personalInfoEdit.style.display = 'grid';
            
            // Hide edit button, show action buttons
            const editBtn = document.getElementById('edit-profile-btn');
            const changePasswordBtn = document.getElementById('change-password-btn');
            
            if (editBtn) editBtn.style.display = 'none';
            if (changePasswordBtn) changePasswordBtn.style.display = 'none';
            
            // Populate edit fields with current values
            const viewFullName = document.getElementById('view-full-name');
            const viewEmail = document.getElementById('view-email');
            const viewPhone = document.getElementById('view-phone');
            
            const editFullName = document.getElementById('edit-full-name');
            const editEmail = document.getElementById('edit-email');
            const editPhone = document.getElementById('edit-phone');
            
            if (viewFullName && editFullName) {
                editFullName.value = viewFullName.textContent;
            }
            if (viewEmail && editEmail) {
                editEmail.value = viewEmail.textContent;
            }
            if (viewPhone && editPhone) {
                editPhone.value = viewPhone.textContent;
            }
        }

        function exitEditMode() {
            // Show view, hide edit form
            const personalInfoView = document.getElementById('personal-info-view');
            const personalInfoEdit = document.getElementById('personal-info-edit');
            
            if (personalInfoView) personalInfoView.style.display = 'grid';
            if (personalInfoEdit) personalInfoEdit.style.display = 'none';
            
            // Show normal buttons, hide action buttons
            const editBtn = document.getElementById('edit-profile-btn');
            const changePasswordBtn = document.getElementById('change-password-btn');
            
            if (editBtn) editBtn.style.display = 'block';
            if (changePasswordBtn) changePasswordBtn.style.display = 'block';
        }

        function saveProfile() {
            // Get values from edit form
            const editFullName = document.getElementById('edit-full-name');
            const editEmail = document.getElementById('edit-email');
            const editPhone = document.getElementById('edit-phone');
            
            if (!editFullName || !editEmail || !editPhone) {
                showToast('Error saving profile information', 'error');
                return;
            }

            const newName = editFullName.value;
            const newEmail = editEmail.value;
            const newPhone = editPhone.value;

            // Show loading state
            const saveBtn = document.getElementById('save-profile-btn');
            saveBtn.classList.add('loading');
            
            // Simulate API call
            setTimeout(() => {
                // Update view mode display
                const viewFullName = document.getElementById('view-full-name');
                const viewEmail = document.getElementById('view-email');
                const viewPhone = document.getElementById('view-phone');
                const welcomeName = document.getElementById('welcome-name');
                
                if (viewFullName) viewFullName.textContent = newName;
                if (viewEmail) viewEmail.textContent = newEmail;
                if (viewPhone) viewPhone.textContent = newPhone;
                if (welcomeName) welcomeName.textContent = newName;

                // Update avatar with new name if using default avatar
                const profileAvatar = document.getElementById('profile-avatar');
                if (profileAvatar && profileAvatar.src.includes('ui-avatars.com')) {
                    const newAvatarUrl = `https://ui-avatars.com/api/?name=${encodeURIComponent(newName)}&background=1a472a&color=FFFFFF&size=140`;
                    profileAvatar.src = newAvatarUrl;
                    
                    // Also update the edit preview
                    const editAvatarPreview = document.getElementById('edit-avatar-preview');
                    if (editAvatarPreview) {
                        editAvatarPreview.src = newAvatarUrl;
                    }
                }

                // Update user info in navbar dropdown
                const dropdownHeader = document.querySelector('.dropdown-header');
                if (dropdownHeader) {
                    dropdownHeader.innerHTML = `<h6 class="dropdown-header">Welcome back, ${newName}!</h6>`;
                }

                // Update navbar avatar
                const navbarAvatar = document.querySelector('.navbar .avatar');
                if (navbarAvatar && navbarAvatar.src.includes('ui-avatars.com')) {
                    navbarAvatar.src = `https://ui-avatars.com/api/?name=${encodeURIComponent(newName)}&background=1a472a&color=FFFFFF`;
                }

                // Exit edit mode
                exitEditMode();

                // Remove loading state
                saveBtn.classList.remove('loading');

                // Show success message
                showToast('Profile information updated successfully!', 'success');
            }, 1500);
        }
    </script>
</body>
</html>